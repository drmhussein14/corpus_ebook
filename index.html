<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Corpus Linguistics eBook</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React and Babel (to run JSX in the browser) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Lucide Icons (Using the stable core library instead of the react wrapper) -->
    <script src="https://unpkg.com/lucide@0.263.1"></script>
    <style>
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* Ensure icons have a default size if not specified */
        svg { width: 1em; height: 1em; }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Custom Component for Icons using the Lucide core library
        const Icon = ({ name, className }) => {
            // Convert CamelCase to kebab-case for the lucide data attribute
            // e.g. BookOpen -> book-open
            const iconName = name.replace(/([a-z0-9])([A-Z])/g, '$1-$2').toLowerCase();
            return <i data-lucide={iconName} className={className}></i>;
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('intro');
            const [progress, setProgress] = useState(0);
            const [quizScores, setQuizScores] = useState({});
            const [isGlossaryOpen, setIsGlossaryOpen] = useState(false);
            const [selectedTerm, setSelectedTerm] = useState(null);
            const [isSubmitted, setIsSubmitted] = useState(false);
            const [labNotes, setLabNotes] = useState({
                cocaFreq: '', bncFreq: '', observations: '', cocaDesign: '', bncDesign: ''
            });

            const glossary = {
                "Empirical": "Based on observation or experience rather than theory.",
                "Lemma": "The base/dictionary form of a word (e.g., [run] for 'running').",
                "Diachronic": "Studying how language changes through history.",
                "Synchronic": "Studying language at one specific point in time.",
                "Lexicographer": "A person who writes dictionaries.",
                "Metadata": "Information about data (e.g., who the speaker is).",
                "Collocation": "Words that naturally go together (e.g., 'heavy rain').",
                "Performance": "Real-world speech, including mistakes.",
                "Competence": "The mental rules of a language."
            };

            const sections = [
                { id: 'intro', title: 'What is a Corpus?', icon: 'BookOpen' },
                { id: 'debate', title: 'The Big Debate', icon: 'MessageSquare' },
                { id: 'methods', title: 'Research Methods', icon: 'FlaskConical' },
                { id: 'lab', title: 'Lab Exercise', icon: 'Laptop' },
            ];

            // Re-render icons whenever the tab changes
            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            }, [activeTab, isGlossaryOpen, selectedTerm, isSubmitted]);

            useEffect(() => {
                const index = sections.findIndex(s => s.id === activeTab);
                setProgress(((index + 1) / sections.length) * 100);
                window.scrollTo(0, 0);
            }, [activeTab]);

            const Term = ({ children }) => (
                <button 
                    onClick={() => { setSelectedTerm(children); setIsGlossaryOpen(true); }}
                    className="text-indigo-600 font-semibold border-b-2 border-indigo-200 hover:border-indigo-600 px-0.5"
                >
                    {children}
                </button>
            );

            return (
                <div className="min-h-screen pb-24 font-sans text-slate-900">
                    {/* Header */}
                    <header className="sticky top-0 z-40 bg-white border-b px-6 py-4 shadow-sm">
                        <div className="max-w-4xl mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <div className="bg-indigo-600 p-2 rounded-lg text-white">
                                    <Icon name="Database" className="w-6 h-6" />
                                </div>
                                <div>
                                    <h1 className="font-bold text-lg leading-tight text-slate-800">Corpus Linguistics</h1>
                                    <p className="text-xs text-slate-500 uppercase font-bold tracking-wider">Chapter 1: Foundations</p>
                                </div>
                            </div>
                            <button onClick={() => {setSelectedTerm(null); setIsGlossaryOpen(true);}} className="text-sm font-semibold flex items-center gap-2 text-slate-600 hover:text-indigo-600 transition-colors">
                                <Icon name="BookMarked" className="w-4 h-4" /> Glossary
                            </button>
                        </div>
                        <div className="max-w-4xl mx-auto mt-4">
                            <div className="h-1.5 w-full bg-slate-100 rounded-full overflow-hidden">
                                <div className="h-full bg-indigo-500 transition-all duration-500 ease-out" style={{ width: `${progress}%` }} />
                            </div>
                        </div>
                    </header>

                    <main className="max-w-4xl mx-auto px-6 py-12">
                        {activeTab === 'intro' && (
                            <div className="space-y-8 animate-in fade-in duration-500">
                                <section className="bg-white p-8 rounded-2xl shadow-sm border border-slate-200">
                                    <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
                                        <Icon name="BookOpen" className="text-indigo-600 w-8 h-8" /> 
                                        What is a Corpus?
                                    </h2>
                                    <p className="text-lg text-slate-600 leading-relaxed mb-6">
                                        The word <span className="text-indigo-600 font-bold italic">corpus</span> comes from Latin and means "body." 
                                        In linguistics, it refers to a massive, digital collection of real-world language samples. 
                                        Think of it as a searchable "language library."
                                    </p>
                                    <div className="grid md:grid-cols-2 gap-6 mt-10">
                                        <div className="p-6 bg-slate-50 rounded-xl border border-slate-200">
                                            <h3 className="font-bold text-indigo-700 uppercase text-xs mb-3 tracking-widest">The Rationalist Way</h3>
                                            <p className="text-sm text-slate-600">Relying on your own "gut feeling" or intuition to decide if a sentence is correct.</p>
                                        </div>
                                        <div className="p-6 bg-indigo-50 rounded-xl border border-indigo-100">
                                            <h3 className="font-bold text-indigo-700 uppercase text-xs mb-3 tracking-widest">The Empirical Way</h3>
                                            <p className="text-sm text-indigo-900 font-medium">Using <Term>Empirical</Term> data (the corpus) to see how language is <span className="underline decoration-indigo-300">actually</span> used by real people.</p>
                                        </div>
                                    </div>
                                </section>
                            </div>
                        )}

                        {activeTab === 'debate' && (
                            <div className="space-y-8 animate-in fade-in duration-500">
                                <h2 className="text-3xl font-bold text-slate-800">Chomsky vs. Corpora</h2>
                                <p className="text-slate-600 mb-8">Noam Chomsky famously argued against corpus linguistics in the 1950s. Here is his challenge and the modern response.</p>
                                
                                <div className="bg-white rounded-2xl border border-slate-200 overflow-hidden flex flex-col md:flex-row shadow-sm">
                                    <div className="p-8 bg-slate-900 text-white md:w-1/2">
                                        <span className="text-xs font-bold text-indigo-400 uppercase mb-2 block tracking-widest">Chomsky's Doubt</span>
                                        <h4 className="text-xl font-bold mb-4">Performance vs. Competence</h4>
                                        <p className="text-slate-300 italic">"Why record slips of the tongue (<Term>Performance</Term>) when we want to know the 'perfect' rules in the head (<Term>Competence</Term>)?"</p>
                                    </div>
                                    <div className="p-8 md:w-1/2 flex items-center">
                                        <p className="text-slate-700 leading-relaxed">
                                            By looking at millions of words, we can filter out one-time errors to find the true, massive patterns of language that actually exist.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'methods' && (
                            <div className="space-y-8 animate-in fade-in duration-500">
                                <h2 className="text-3xl font-bold text-slate-800">Research Methods</h2>
                                <div className="grid md:grid-cols-2 gap-6">
                                    <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                                        <div className="w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600 mb-4 font-bold uppercase tracking-tighter">Qn</div>
                                        <h4 className="font-bold text-lg mb-2 text-slate-800">Quantitative</h4>
                                        <p className="text-sm text-slate-600">Focuses on numbers and stats. "How often does a word appear per million?"</p>
                                    </div>
                                    <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                                        <div className="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600 mb-4 font-bold uppercase tracking-tighter">Ql</div>
                                        <h4 className="font-bold text-lg mb-2 text-slate-800">Qualitative</h4>
                                        <p className="text-sm text-slate-600">Focuses on detail. "Why did a <Term>Lexicographer</Term> choose this specific example for the dictionary?"</p>
                                    </div>
                                </div>
                                <div className="bg-indigo-900 text-white p-8 rounded-2xl shadow-md">
                                    <div className="flex items-center gap-3 mb-4 text-indigo-300 font-bold uppercase tracking-widest text-xs">
                                        <Icon name="FlaskConical" className="w-5 h-5" /> Quick Fact
                                    </div>
                                    <h4 className="text-xl font-bold mb-2 text-white">Observation vs. Manipulation</h4>
                                    <p className="text-indigo-100 leading-relaxed">
                                        Corpora observe language in its natural state. Experiments manipulate variables (like stress or time) to see how things change.
                                    </p>
                                </div>
                            </div>
                        )}

                        {activeTab === 'lab' && (
                            <div className="space-y-8 animate-in fade-in duration-500">
                                <h2 className="text-3xl font-bold text-slate-800">Lab: Exploring Interfaces</h2>
                                {isSubmitted ? (
                                    <div className="bg-emerald-50 border border-emerald-200 p-12 rounded-3xl text-center space-y-6 shadow-sm">
                                        <div className="w-20 h-20 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto">
                                            <Icon name="Trophy" className="w-10 h-10" />
                                        </div>
                                        <h3 className="text-2xl font-bold text-emerald-900">Lab Exercise Complete!</h3>
                                        <p className="text-emerald-700">Your results have been saved to the session notebook.</p>
                                        <button onClick={() => setIsSubmitted(false)} className="text-emerald-600 font-bold hover:underline">Edit Results</button>
                                    </div>
                                ) : (
                                    <div className="grid md:grid-cols-2 gap-8">
                                        <div className="space-y-4">
                                            <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                                                <h4 className="font-bold text-indigo-700 mb-2">COCA Search</h4>
                                                <p className="text-sm text-slate-500 mb-4">Search the <Term>Lemma</Term> [movie] in American English.</p>
                                                <input type="text" placeholder="Freq per million" className="w-full p-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none text-slate-700" value={labNotes.cocaFreq} onChange={e => setLabNotes({...labNotes, cocaFreq: e.target.value})} />
                                            </div>
                                            <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                                                <h4 className="font-bold text-slate-700 mb-2">BNC Search</h4>
                                                <p className="text-sm text-slate-500 mb-4">Search "movie" in British corpus.</p>
                                                <input type="text" placeholder="Freq per million" className="w-full p-2 border border-slate-200 rounded-lg focus:ring-2 focus:ring-slate-500 outline-none text-slate-700" value={labNotes.bncFreq} onChange={e => setLabNotes({...labNotes, bncFreq: e.target.value})} />
                                            </div>
                                        </div>
                                        <div className="bg-white p-6 rounded-xl border border-slate-200 shadow-sm flex flex-col">
                                            <h4 className="font-bold mb-4 flex items-center gap-2 text-slate-800">
                                                <Icon name="Search" className="w-4 h-4 text-slate-400" /> Lab Notebook
                                            </h4>
                                            <textarea className="flex-1 p-3 bg-slate-50 border border-slate-200 rounded-xl text-sm mb-4 min-h-[150px] outline-none focus:ring-2 focus:ring-indigo-500 text-slate-700" placeholder="Write your observations here..." value={labNotes.observations} onChange={e => setLabNotes({...labNotes, observations: e.target.value})} />
                                            <button onClick={() => setIsSubmitted(true)} className="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition-colors shadow-md shadow-indigo-200 flex items-center justify-center gap-2">
                                                <Icon name="Send" className="w-4 h-4" /> Submit Results
                                            </button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}
                    </main>

                    {/* Glossary Modal */}
                    {isGlossaryOpen && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-6 animate-in fade-in duration-300">
                            <div className="absolute inset-0 bg-slate-900/40 backdrop-blur-sm" onClick={() => setIsGlossaryOpen(false)}></div>
                            <div className="relative bg-white w-full max-w-lg rounded-3xl shadow-2xl overflow-hidden">
                                <div className="bg-indigo-600 p-6 text-white flex justify-between items-center">
                                    <div className="flex items-center gap-3 text-white">
                                        <Icon name="BookMarked" className="w-6 h-6" />
                                        <h3 className="text-xl font-bold italic tracking-wide">Glossary</h3>
                                    </div>
                                    <button onClick={() => setIsGlossaryOpen(false)} className="hover:bg-white/20 rounded-full p-1 transition-colors">
                                        <Icon name="X" className="w-6 h-6 text-white" />
                                    </button>
                                </div>
                                <div className="p-8 max-h-[60vh] overflow-y-auto custom-scrollbar">
                                    {selectedTerm ? (
                                        <div className="animate-in slide-in-from-left-4 duration-300">
                                            <h4 className="text-2xl font-bold text-slate-900 mb-2">{selectedTerm}</h4>
                                            <p className="text-slate-600 text-lg leading-relaxed">{glossary[selectedTerm]}</p>
                                            <button onClick={() => setSelectedTerm(null)} className="mt-6 text-sm font-bold text-indigo-600 hover:text-indigo-800 transition-colors">‚Üê BACK TO LIST</button>
                                        </div>
                                    ) : (
                                        <div className="space-y-2">
                                            {Object.entries(glossary).map(([term, def]) => (
                                                <button key={term} onClick={() => setSelectedTerm(term)} className="w-full text-left p-4 rounded-xl border border-slate-100 hover:border-indigo-200 hover:bg-indigo-50 transition-all group">
                                                    <h5 className="font-bold text-slate-800 group-hover:text-indigo-700 transition-colors">{term}</h5>
                                                    <p className="text-sm text-slate-500 line-clamp-1">{def}</p>
                                                </button>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Navigation */}
                    <nav className="fixed bottom-0 w-full bg-white border-t p-4 shadow-[0_-4px_10px_rgba(0,0,0,0.05)] z-30">
                        <div className="max-w-4xl mx-auto flex justify-between px-4">
                            <button disabled={activeTab === 'intro'} onClick={() => setActiveTab(sections[sections.findIndex(s => s.id === activeTab) - 1].id)} className="flex items-center gap-2 font-bold text-slate-600 hover:text-indigo-600 disabled:opacity-30 transition-colors">
                                <Icon name="ChevronLeft" className="w-5 h-5" /> PREVIOUS
                            </button>
                            <button disabled={activeTab === 'lab'} onClick={() => setActiveTab(sections[sections.findIndex(s => s.id === activeTab) + 1].id)} className="bg-slate-900 text-white px-8 py-3 rounded-xl font-bold flex items-center gap-2 hover:bg-indigo-600 transition-all shadow-md disabled:opacity-30">
                                NEXT SECTION <Icon name="ChevronRight" className="w-5 h-5" />
                            </button>
                        </div>
                    </nav>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
